<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Physics</title>
    </head>
    <body>
        <canvas id="canvas" width="1000" height="400"></canvas>
        <br>
        <button id="start"type="button" name="button">Start</button>
        <form id="newProjectileForm" onsubmit="return false">
            <br>
            <span><strong>Add projectile:</strong></span>
            <br>
            <span>Position (initial)</span><button onclick="selectPosition=true;" type="button" name="button">Click for pos</button>
            <br>
            <span>  x: </span><input id="inputPosX" style="width:75px" type="number" name="" value="600">
            <span>  y: </span><input id="inputPosY" style="width:75px" type="number" name="" value="280">
            <br>
            <span>Velocity (initial)</span>
            <br>
            <span>  x: </span><input id="inputVelX" style="width:75px" type="number" name="" value="0">
            <span>  y: </span><input id="inputVelY" style="width:75px" type="number" name="" value="0">
            <br>
            <select class="" id="inputColor">
                <option value="red">Red</option>
                <option value="green">Green</option>
                <option value="blue">Blue</option>
            </select>
            <button id="addProjectileButton" type="submit" name="button">Add</button>
            <br>
            <br>
        </form>
        <div id="logging" class="logging">
            <span id="time">0ms</span>
            <div id="projectiles" class=""></div>
        </div>

    </body>
</html>
<!-- Dependencies -->
<!-- <script src="./Equations.js" type="text/javascript"></script> -->
<script src="./Projectile.js" type="text/javascript"></script>
<script src="./collision_handler.js"></script>

<!-- Main Script -->
<script src="./scene.js" type="text/javascript"></script>

<!-- Canvas controller -->
<script type="text/javascript">

var selectPosition = false
var rect = null

window.onload = function () {
    c = document.getElementById("canvas");
    cc = c.getContext("2d");

    render()

    // Set form min/max values
    rect = c.getBoundingClientRect();
    document.getElementById("inputPosX").min = 0
    document.getElementById("inputPosX").max = rect.right
    document.getElementById("inputPosY").min = 0
    document.getElementById("inputPosY").max = rect.bottom

    /* Uncomment for fun */
    var colors = ["white", "green", "purple", "blue", "red"]
     for(var i = 25; i < cc.canvas.width-20; i+=61) {
         for(var j = 25; j < cc.canvas.height-20; j+=61) {
             if (i % 10 == 0) {
                 var p = new Projectile({x: i, y: cc.canvas.height - j, vxi: Math.random()*1000, vyi: Math.random()*1000, color: colors[j%colors.length], radius: 25})
                 addProjectile(id=null, p)
             }

         }
     }
}

canvas.addEventListener('click', function(evt) {
    if (selectPosition) {
        var rect = c.getBoundingClientRect();
        mousePos = {
            x: evt.clientX - rect.left,
            y: evt.clientY - rect.top
        };
        document.getElementById("inputPosX").value = mousePos.x
        document.getElementById("inputPosY").value = mousePos.y
        addProjectile()

        console.log(mousePos);
    }
    selectPosition = false
});

// Form events
// document.getElementById("stop").addEventListener("click", togglePause)
document.getElementById("start").addEventListener("click", start)
document.getElementById("addProjectileButton").addEventListener("click", addProjectile)

</script>
