<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Physics</title>
    </head>
    <body>
        <canvas id="canvas" width="1000" height="400"></canvas>
        <br>
        <h1>Instructions</h1>
        <p>1. Add projectile(s)</p>
        <p>2. Press "Start"</p>
        <p>(3.) Reload the page to restart</p>
        <p>Note: Adding projectiles during simulation will not work :)</p>
        <form id="newProjectileForm" onsubmit="return false">
            <!-- <h1>Add projectile</h1> -->
            <span><strong>Add projectile:</strong></span>
            <br>
            <span>Velocity (initial)</span>
            <br>
            <span>  x: </span><input id="inputVelX" style="width:75px" type="number" name="" value="50">
            <span>  y: </span><input id="inputVelY" style="width:75px" type="number" name="" value="50">
            <br>
            <span>Position (initial)</span>  <button onclick="selectPosition=true;" type="button" name="button">Click here</button><span>to indicate a position with mouse.</span>
            <br>
            <span>  x: </span><input id="inputPosX" style="width:75px" type="number" name="" value="600">
            <span>  y: </span><input id="inputPosY" style="width:75px" type="number" name="" value="280">
            <br>
            <span>Color:</span>
            <select class="" id="inputColor">
                <option value="red">Red</option>
                <option value="green">Green</option>
                <option value="blue">Blue</option>
            </select>
            <br>
            <button id="addProjectileButton" type="submit" name="button">Add projectile</button>
            <br>
            <br>
        </form>
        <button id="stop"type="button" name="button">Start</button>

        <h1>Logging</h1>
        <div id="logging" class="logging">
            <span id="time">0ms</span>
            <div id="projectiles" class=""></div>
        </div>

    </body>
</html>
<!-- Dependencies -->
<script src="./analytical/Equations.js" type="text/javascript"></script>
<script src="./analytical/Projectile.js" type="text/javascript"></script>

<!-- Main Script -->
<script src="./analytical/scene.js" type="text/javascript"></script>

<!-- Canvas controller -->
<script type="text/javascript">
var stop = true
var selectPosition = false
var started = false
var rect = null

function togglePause() {
    stop = !stop;
    stop ? this.innerHTML = "Play" : this.innerHTML = "Pause";
    if (!started) {
        document.getElementById("newProjectileForm").enabled = false
    }
    started = true
}
window.onload = function () {
    c = document.getElementById("canvas");
    cc = c.getContext("2d");
    setInterval(update, 1000/60);
    render()

    // Set form min/max values
    rect = c.getBoundingClientRect();
    document.getElementById("inputPosX").min = 0
    document.getElementById("inputPosX").max = rect.right
    document.getElementById("inputPosY").min = 0
    document.getElementById("inputPosY").max = rect.bottom
}

canvas.addEventListener('click', function(evt) {
    if (selectPosition) {
        var rect = c.getBoundingClientRect();
        mousePos = {
            x: evt.clientX - rect.left,
            y: evt.clientY - rect.top
        };
        document.getElementById("inputPosX").value = mousePos.x
        document.getElementById("inputPosY").value = mousePos.y
        addProjectile()

        console.log(mousePos);
    }
    selectPosition = false
});

// Form events
document.getElementById("stop").addEventListener("click", togglePause)
document.getElementById("addProjectileButton").addEventListener("click", addProjectile)

</script>
