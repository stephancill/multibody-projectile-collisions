<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Physics</title>
    </head>
    <body id="grad">
        <div id="center">
            <h1>Simulation of Projectile Motion and Collisions in 2D Space</h1>
            <h3>Stephan Cilliers, Emile Tredoux</h3>
            <canvas id="canvas" width="1000" height="400"></canvas>
            <div style="margin-top: 20px">
                <button id="start"type="button" name="button">Start</button><button id="fun">Load fun</button>
            </div>
               
        </div>
        <br>
        
        <form id="newProjectileForm" onsubmit="return false">
            <br>
            <span><strong>Add projectile:</strong></span>
            <br>
            <span>Position (initial)</span><button onclick="selectPosition=true;" type="button" name="button">Click for pos</button>
            <br>
            <span>  x: </span><input id="inputPosX" style="width:75px" type="number" name="" value="600">
            <span>  y: </span><input id="inputPosY" style="width:75px" type="number" name="" value="280">
            <br>
            <span>Velocity (initial)</span>
            <br>
            <span>  x: </span><input id="inputVelX" style="width:75px" type="number" name="" value="0">
            <span>  y: </span><input id="inputVelY" style="width:75px" type="number" name="" value="0">
            <br>
            <select class="" id="inputColor">
                <option value="red">Red</option>
                <option value="green">Green</option>
                <option value="blue">Blue</option>
            </select>
            <button id="addProjectileButton" type="submit" name="button">Add</button>
            <br>
            <br>
        </form>
        <div id="logging" class="logging">
            <span id="time">0ms</span>
            <div id="projectiles" class=""></div>
        </div>

    </body>
</html>
<!-- Dependencies -->
<script>var cc, rect;</script>
<script src="./scripts/Projectile.js" type="text/javascript"></script>
<script src="./scripts/collision_handler.js"></script>

<!-- Main Script -->
<script src="./scripts/scene.js" type="text/javascript"></script>

<!-- Canvas controller -->
<script type="text/javascript">

var selectPosition = false

function getRandomArbitrary(min, max) {
    return Math.random() * (max - min) + min;
}

window.onload = function () {
    c = document.getElementById("canvas");
    cc = c.getContext("2d");

    render()

    // Set form min/max values
    rect = c.getBoundingClientRect();
    document.getElementById("inputPosX").min = 0
    document.getElementById("inputPosX").max = rect.right
    document.getElementById("inputPosY").min = 0
    document.getElementById("inputPosY").max = rect.bottom

}

canvas.addEventListener('click', function(evt) {
    if (selectPosition) {
        mousePos = {
            x: evt.clientX - rect.left,
            y: evt.clientY - rect.top
        };
        document.getElementById("inputPosX").value = mousePos.x
        document.getElementById("inputPosY").value = mousePos.y
        addProjectile()

        console.log(mousePos);
    }
    selectPosition = false
});

// Add event listener for `click` events.
canvas.addEventListener('click', function(event) {
    var elem = c,
    elemLeft = elem.offsetLeft,
    elemTop = elem.offsetTop
    
    var x = event.pageX - elemLeft,
        y = event.pageY - elemTop;

    // Collision detection between clicked offset and element.
    projectiles.forEach(function(i) {
        var pos = projectiles_map[i].pos,
        r = projectiles_map[i].radius
        if (x > pos.x-r && x < pos.x+r
            && y > pos.y-r && y < pos.y+r) {
            alert('clicked an element');
        }
    });

}, false);

// Form events
// document.getElementById("stop").addEventListener("click", togglePause)
document.getElementById("start").addEventListener("click", start)
document.getElementById("addProjectileButton").addEventListener("click", addProjectile)
document.getElementById("fun").addEventListener("click", fun)

</script>
<style>
#grad {
    height: 98.4vh;
    width: 98vw;
    background: linear-gradient(to bottom right, #24C6DC, #514A9D); /* Standard syntax */
}

#center {
    display: flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
}

</style>
